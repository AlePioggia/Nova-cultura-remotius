<!-- my-card-list.component.html -->
<dx-list [dataSource]="data" height="100%" class="my-card-list">
  <div *dxTemplate="let itemData of 'item'" class="my-card-list-item">
    <div class="d-flex justify-content-center mb-4">
      <div class="profile-image-border">
        <dx-gallery
          [dataSource]="[imageUrl]"
          [height]="200"
          [width]="200"
          [loop]="false"
          [showNavButtons]="false"
        ></dx-gallery>
      </div>
    </div>
    <div class="text-center border p-3">
      <h3>{{ itemData?.firstName }} {{ itemData?.lastName }}</h3>
      <h5>{{ itemData.subjects }}</h5>
      <p>
        <span class="font-weight-bold text-uppercase text-secondary">Email</span
        ><br /><span class="text-dark">{{ itemData?.mail }}</span>
      </p>
      <p>
        <span class="font-weight-bold text-uppercase text-secondary">Et√†</span
        ><br /><span class="text-dark">{{ itemData?.age }}</span>
      </p>
      <div class="d-flex justify-content-around mt-4" *ngIf="!isTeacher">
        <dx-button
          text="Prenota"
          type="default"
          [width]="160"
          [stylingMode]="'contained'"
          (onClick)="makeReservation(itemData)"
        ></dx-button>
        <dx-button
          text="Chiedi info"
          type="default"
          [width]="160"
          [stylingMode]="'contained'"
          (onClick)="openChat()"
        ></dx-button>
        <dx-button
          text="Recensisci"
          type="default"
          [width]="160"
          [stylingMode]="'contained'"
          (onClick)="showReviewPopup()"
        ></dx-button>
      </div>
    </div>
  </div>
</dx-list>

<dx-popup
  [visible]="isPopupVisible"
  title="Inserisci una recensione"
  (onHiding)="hideReviewPopup()"
  height="300"
  class="p-3 border rounded custom-popup"
>
  <dx-form [formData]="review" class="form-group">
    <dxi-item>
      <div
        dataField="vote"
        class="stars-container my-2 d-flex align-items-center"
      >
        <label class="vote-label">Valutazione: </label>
        <span
          *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
          class="fa-star"
          [ngClass]="{
            'fas selected-star': review.vote >= star,
            far: review.vote < star
          }"
          (click)="setVote(star)"
        >
        </span>
      </div>
    </dxi-item>
    <dxi-item
      dataField="title"
      [isRequired]="true"
      class="my-2 border-bottom"
    ></dxi-item>
    <dxi-item
      dataField="description"
      editorType="dxTextArea"
      [isRequired]="true"
      class="my-2 border-bottom"
    ></dxi-item>
  </dx-form>
  <div class="d-flex justify-content-center">
    <dx-button
      text="Invia"
      (onClick)="submitReview()"
      class="btn btn-primary mt-3 custom-button"
    ></dx-button>
  </div>
</dx-popup>
